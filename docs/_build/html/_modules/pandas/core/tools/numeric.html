<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pandas.core.tools.numeric &mdash; BabyDragon  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            BabyDragon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tasks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tasks/llm_task.html">llm_task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tasks/multi_kernel_task.html">multi_kernel_task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tasks/base_task.html">base_task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tasks/topic_tree_task.html">topic_tree_task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tasks/embedding_task.html">embedding_task</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory/Kernels:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/kernels/memory_kernel.html">memory_kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/kernels/kernel_clustering.html">kernel_clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/kernels/multi_kernel.html">multi_kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/kernels/multi_kernel_visualization.html">multi_kernel_visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/kernels/kernel_utils.html">kernel_utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory/Threads:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/threads/base_thread.html">base_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/threads/fifo_thread.html">fifo_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/threads/vector_thread.html">vector_thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/threads/todo/python_thread.html">python_thread</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory/Indexes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/python_index.html">python_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/memory_index.html">memory_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/pandas_index.html">pandas_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/youtube_index.html">youtube_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/parquet_index.html">parquet_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/wiki_index.html">wiki_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/gutenberg_index.html">gutenberg_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/github_index.html">github_index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/indexes/todo/multi_index.html">multi_index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chat:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../chat/base_chat.html">base_chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chat/memory_chat.html">memory_chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chat/chat.html">chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chat/prompts/perspective_prompt.html">perspective_prompt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chat/prompts/default_prompts.html">default_prompts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utils:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/multithreading.html">multithreading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/pandas.html">pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/hf_datasets.html">hf_datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/chatml.html">chatml</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models/embedders:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/embedders/ada2.html">ada2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/embedders/cohere.html">cohere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/embedders/sbert.html">sbert</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models/generators:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/generators/cohere.html">cohere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/generators/chatgpt.html">chatgpt</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Processors:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/github_processors.html">github_processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/os_processor.html">os_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/git_metadata.html">git_metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/visitors.html">visitors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/python_parser.html">python_parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/todo/subs_parser.html">subs_parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/todo/latex_parser.html">latex_parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/todo/md_parser.html">md_parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/todo/wiki_parser.html">wiki_parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/parsers/todo/git_processor.html">git_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/arxiv_processor.html">arxiv_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/wiki_processor.html">wiki_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/chatgpt_processor.html">chatgpt_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/mit_course_processor.html">mit_course_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/youtube_processor.html">youtube_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/pubmed_processor.html">pubmed_processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../processors/todo/gutenberg_processor.html">gutenberg_processor</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Apps:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../apps/auto_perspective/perspective.html">perspective</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">BabyDragon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pandas.core.tools.numeric</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pandas.core.tools.numeric</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pandas._libs</span> <span class="kn">import</span> <span class="n">lib</span>
<span class="kn">from</span> <span class="nn">pandas._typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DateTimeErrorChoices</span><span class="p">,</span>
    <span class="n">DtypeBackend</span><span class="p">,</span>
    <span class="n">npt</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.util._validators</span> <span class="kn">import</span> <span class="n">check_dtype_backend</span>

<span class="kn">from</span> <span class="nn">pandas.core.dtypes.cast</span> <span class="kn">import</span> <span class="n">maybe_downcast_numeric</span>
<span class="kn">from</span> <span class="nn">pandas.core.dtypes.common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ensure_object</span><span class="p">,</span>
    <span class="n">is_bool_dtype</span><span class="p">,</span>
    <span class="n">is_datetime_or_timedelta_dtype</span><span class="p">,</span>
    <span class="n">is_decimal</span><span class="p">,</span>
    <span class="n">is_integer_dtype</span><span class="p">,</span>
    <span class="n">is_number</span><span class="p">,</span>
    <span class="n">is_numeric_dtype</span><span class="p">,</span>
    <span class="n">is_scalar</span><span class="p">,</span>
    <span class="n">is_string_dtype</span><span class="p">,</span>
    <span class="n">needs_i8_conversion</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pandas.core.dtypes.generic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ABCIndex</span><span class="p">,</span>
    <span class="n">ABCSeries</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas.core.arrays</span> <span class="kn">import</span> <span class="n">BaseMaskedArray</span>
<span class="kn">from</span> <span class="nn">pandas.core.arrays.string_</span> <span class="kn">import</span> <span class="n">StringDtype</span>


<div class="viewcode-block" id="to_numeric"><a class="viewcode-back" href="../../../../utils/pandas.html#pandas.to_numeric">[docs]</a><span class="k">def</span> <span class="nf">to_numeric</span><span class="p">(</span>
    <span class="n">arg</span><span class="p">,</span>
    <span class="n">errors</span><span class="p">:</span> <span class="n">DateTimeErrorChoices</span> <span class="o">=</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span>
    <span class="n">downcast</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;signed&quot;</span><span class="p">,</span> <span class="s2">&quot;unsigned&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype_backend</span><span class="p">:</span> <span class="n">DtypeBackend</span> <span class="o">|</span> <span class="n">lib</span><span class="o">.</span><span class="n">NoDefault</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">no_default</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert argument to a numeric type.</span>

<span class="sd">    The default return dtype is `float64` or `int64`</span>
<span class="sd">    depending on the data supplied. Use the `downcast` parameter</span>
<span class="sd">    to obtain other dtypes.</span>

<span class="sd">    Please note that precision loss may occur if really large numbers</span>
<span class="sd">    are passed in. Due to the internal limitations of `ndarray`, if</span>
<span class="sd">    numbers smaller than `-9223372036854775808` (np.iinfo(np.int64).min)</span>
<span class="sd">    or larger than `18446744073709551615` (np.iinfo(np.uint64).max) are</span>
<span class="sd">    passed in, it is very likely they will be converted to float so that</span>
<span class="sd">    they can be stored in an `ndarray`. These warnings apply similarly to</span>
<span class="sd">    `Series` since it internally leverages `ndarray`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arg : scalar, list, tuple, 1-d array, or Series</span>
<span class="sd">        Argument to be converted.</span>
<span class="sd">    errors : {&#39;ignore&#39;, &#39;raise&#39;, &#39;coerce&#39;}, default &#39;raise&#39;</span>
<span class="sd">        - If &#39;raise&#39;, then invalid parsing will raise an exception.</span>
<span class="sd">        - If &#39;coerce&#39;, then invalid parsing will be set as NaN.</span>
<span class="sd">        - If &#39;ignore&#39;, then invalid parsing will return the input.</span>
<span class="sd">    downcast : str, default None</span>
<span class="sd">        Can be &#39;integer&#39;, &#39;signed&#39;, &#39;unsigned&#39;, or &#39;float&#39;.</span>
<span class="sd">        If not None, and if the data has been successfully cast to a</span>
<span class="sd">        numerical dtype (or if the data was numeric to begin with),</span>
<span class="sd">        downcast that resulting data to the smallest numerical dtype</span>
<span class="sd">        possible according to the following rules:</span>

<span class="sd">        - &#39;integer&#39; or &#39;signed&#39;: smallest signed int dtype (min.: np.int8)</span>
<span class="sd">        - &#39;unsigned&#39;: smallest unsigned int dtype (min.: np.uint8)</span>
<span class="sd">        - &#39;float&#39;: smallest float dtype (min.: np.float32)</span>

<span class="sd">        As this behaviour is separate from the core conversion to</span>
<span class="sd">        numeric values, any errors raised during the downcasting</span>
<span class="sd">        will be surfaced regardless of the value of the &#39;errors&#39; input.</span>

<span class="sd">        In addition, downcasting will only occur if the size</span>
<span class="sd">        of the resulting data&#39;s dtype is strictly larger than</span>
<span class="sd">        the dtype it is to be cast to, so if none of the dtypes</span>
<span class="sd">        checked satisfy that specification, no downcasting will be</span>
<span class="sd">        performed on the data.</span>
<span class="sd">    dtype_backend : {&quot;numpy_nullable&quot;, &quot;pyarrow&quot;}, defaults to NumPy backed DataFrames</span>
<span class="sd">        Which dtype_backend to use, e.g. whether a DataFrame should have NumPy</span>
<span class="sd">        arrays, nullable dtypes are used for all dtypes that have a nullable</span>
<span class="sd">        implementation when &quot;numpy_nullable&quot; is set, pyarrow is used for all</span>
<span class="sd">        dtypes if &quot;pyarrow&quot; is set.</span>

<span class="sd">        The dtype_backends are still experimential.</span>

<span class="sd">        .. versionadded:: 2.0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ret</span>
<span class="sd">        Numeric if parsing succeeded.</span>
<span class="sd">        Return type depends on input.  Series if Series, otherwise ndarray.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    DataFrame.astype : Cast argument to a specified dtype.</span>
<span class="sd">    to_datetime : Convert argument to datetime.</span>
<span class="sd">    to_timedelta : Convert argument to timedelta.</span>
<span class="sd">    numpy.ndarray.astype : Cast a numpy array to a specified type.</span>
<span class="sd">    DataFrame.convert_dtypes : Convert dtypes.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Take separate series and convert to numeric, coercing when told to</span>

<span class="sd">    &gt;&gt;&gt; s = pd.Series([&#39;1.0&#39;, &#39;2&#39;, -3])</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s)</span>
<span class="sd">    0    1.0</span>
<span class="sd">    1    2.0</span>
<span class="sd">    2   -3.0</span>
<span class="sd">    dtype: float64</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, downcast=&#39;float&#39;)</span>
<span class="sd">    0    1.0</span>
<span class="sd">    1    2.0</span>
<span class="sd">    2   -3.0</span>
<span class="sd">    dtype: float32</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, downcast=&#39;signed&#39;)</span>
<span class="sd">    0    1</span>
<span class="sd">    1    2</span>
<span class="sd">    2   -3</span>
<span class="sd">    dtype: int8</span>
<span class="sd">    &gt;&gt;&gt; s = pd.Series([&#39;apple&#39;, &#39;1.0&#39;, &#39;2&#39;, -3])</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, errors=&#39;ignore&#39;)</span>
<span class="sd">    0    apple</span>
<span class="sd">    1      1.0</span>
<span class="sd">    2        2</span>
<span class="sd">    3       -3</span>
<span class="sd">    dtype: object</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, errors=&#39;coerce&#39;)</span>
<span class="sd">    0    NaN</span>
<span class="sd">    1    1.0</span>
<span class="sd">    2    2.0</span>
<span class="sd">    3   -3.0</span>
<span class="sd">    dtype: float64</span>

<span class="sd">    Downcasting of nullable integer and floating dtypes is supported:</span>

<span class="sd">    &gt;&gt;&gt; s = pd.Series([1, 2, 3], dtype=&quot;Int64&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, downcast=&quot;integer&quot;)</span>
<span class="sd">    0    1</span>
<span class="sd">    1    2</span>
<span class="sd">    2    3</span>
<span class="sd">    dtype: Int8</span>
<span class="sd">    &gt;&gt;&gt; s = pd.Series([1.0, 2.1, 3.0], dtype=&quot;Float64&quot;)</span>
<span class="sd">    &gt;&gt;&gt; pd.to_numeric(s, downcast=&quot;float&quot;)</span>
<span class="sd">    0    1.0</span>
<span class="sd">    1    2.1</span>
<span class="sd">    2    3.0</span>
<span class="sd">    dtype: Float32</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">downcast</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;signed&quot;</span><span class="p">,</span> <span class="s2">&quot;unsigned&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid downcasting method provided&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">errors</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid error value specified&quot;</span><span class="p">)</span>

    <span class="n">check_dtype_backend</span><span class="p">(</span><span class="n">dtype_backend</span><span class="p">)</span>

    <span class="n">is_series</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_index</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_scalars</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">ABCSeries</span><span class="p">):</span>
        <span class="n">is_series</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">values</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">ABCIndex</span><span class="p">):</span>
        <span class="n">is_index</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">needs_i8_conversion</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="s2">&quot;i8&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">values</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_decimal</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_number</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">arg</span>
        <span class="n">is_scalars</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">arg</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s2">&quot;ndim&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;arg must be a list, tuple, 1-d array, or Series&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="n">orig_values</span> <span class="o">=</span> <span class="n">values</span>

    <span class="c1"># GH33013: for IntegerArray &amp; FloatingArray extract non-null values for casting</span>
    <span class="c1"># save mask to reconstruct the full array after casting</span>
    <span class="n">mask</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">BaseMaskedArray</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">_mask</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>

    <span class="n">values_dtype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">ArrowDtype</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">new_mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">is_datetime_or_timedelta_dtype</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">ensure_object</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">coerce_numeric</span> <span class="o">=</span> <span class="n">errors</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;raise&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">new_mask</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">maybe_convert_numeric</span><span class="p">(</span>  <span class="c1"># type: ignore[call-overload]  # noqa</span>
                <span class="n">values</span><span class="p">,</span>
                <span class="nb">set</span><span class="p">(),</span>
                <span class="n">coerce_numeric</span><span class="o">=</span><span class="n">coerce_numeric</span><span class="p">,</span>
                <span class="n">convert_to_masked_nullable</span><span class="o">=</span><span class="n">dtype_backend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">lib</span><span class="o">.</span><span class="n">no_default</span>
                <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">,</span> <span class="n">StringDtype</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">orig_values</span>

    <span class="k">if</span> <span class="n">new_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Remove unnecessary values, is expected later anyway and enables</span>
        <span class="c1"># downcasting</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">new_mask</span><span class="p">]</span>
    <span class="k">elif</span> <span class="p">(</span>
        <span class="n">dtype_backend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">lib</span><span class="o">.</span><span class="n">no_default</span>
        <span class="ow">and</span> <span class="n">new_mask</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">,</span> <span class="n">StringDtype</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">new_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>

    <span class="c1"># attempt downcast only if the data has been successfully converted</span>
    <span class="c1"># to a numerical dtype and if a downcast method has been specified</span>
    <span class="k">if</span> <span class="n">downcast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="n">typecodes</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">downcast</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;signed&quot;</span><span class="p">):</span>
            <span class="n">typecodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">typecodes</span><span class="p">[</span><span class="s2">&quot;Integer&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">downcast</span> <span class="o">==</span> <span class="s2">&quot;unsigned&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">typecodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">typecodes</span><span class="p">[</span><span class="s2">&quot;UnsignedInteger&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">downcast</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
            <span class="n">typecodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">typecodes</span><span class="p">[</span><span class="s2">&quot;Float&quot;</span><span class="p">]</span>

            <span class="c1"># pandas support goes only to np.float32,</span>
            <span class="c1"># as float dtypes smaller than that are</span>
            <span class="c1"># extremely rare and not well supported</span>
            <span class="n">float_32_char</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">char</span>
            <span class="n">float_32_ind</span> <span class="o">=</span> <span class="n">typecodes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">float_32_char</span><span class="p">)</span>
            <span class="n">typecodes</span> <span class="o">=</span> <span class="n">typecodes</span><span class="p">[</span><span class="n">float_32_ind</span><span class="p">:]</span>

        <span class="k">if</span> <span class="n">typecodes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># from smallest to largest</span>
            <span class="k">for</span> <span class="n">typecode</span> <span class="ow">in</span> <span class="n">typecodes</span><span class="p">:</span>
                <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">typecode</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">&lt;=</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">maybe_downcast_numeric</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>

                    <span class="c1"># successful conversion</span>
                    <span class="k">if</span> <span class="n">values</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">dtype</span><span class="p">:</span>
                        <span class="k">break</span>

    <span class="c1"># GH33013: for IntegerArray, BooleanArray &amp; FloatingArray need to reconstruct</span>
    <span class="c1"># masked array</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_string_dtype</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="n">new_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_mask</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="c1"># GH 52588</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">new_mask</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

        <span class="kn">from</span> <span class="nn">pandas.core.arrays</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">ArrowExtensionArray</span><span class="p">,</span>
            <span class="n">BooleanArray</span><span class="p">,</span>
            <span class="n">FloatingArray</span><span class="p">,</span>
            <span class="n">IntegerArray</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">klass</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">IntegerArray</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">BooleanArray</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">FloatingArray</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_integer_dtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">IntegerArray</span>
        <span class="k">elif</span> <span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">):</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">BooleanArray</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">FloatingArray</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">klass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dtype_backend</span> <span class="o">==</span> <span class="s2">&quot;pyarrow&quot;</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_dtype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">ArrowDtype</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">ArrowExtensionArray</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">__arrow_array__</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">is_series</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">_constructor</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">arg</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_index</span><span class="p">:</span>
        <span class="c1"># because we want to coerce to numeric if possible,</span>
        <span class="c1"># do not use _shallow_copy</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_scalars</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">values</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Tommaso Furlanello, and Daniel Hug.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>